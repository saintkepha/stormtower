// Generated by CoffeeScript 1.7.1
(function() {
  var crypto, extend;

  crypto = require('crypto');

  extend = require('util')._extend;

  this.include = function() {
    var tower;
    tower = this.settings.agent;
    this.head({
      '/minions': function() {
        var checksum;
        checksum = tower.minions.checksum();
        tower.log("checksum: " + checksum);
        this.res.set('Content-MD5', checksum);
        return this.send('');
      }
    });
    this.get({
      '/minions': function() {
        return this.send(tower.minions.list());
      }
    });
    this.get({
      '/minions/:id': function() {
        var match;
        match = tower.minions.get(this.params.id);
        if (match != null) {
          return this.send(match);
        } else {
          return this.send(404);
        }
      }
    });
    return this.head({
      '/minions/:id': function() {
        var copy, match, md5;
        match = tower.minions.get(this.params.id);
        if (match != null) {
          copy = extend({}, match);
          delete copy.os;
          md5 = crypto.createHash("md5");
          md5.update(JSON.stringify(copy));
          this.res.set('Content-MD5', md5.digest("hex"));
          return this.send('');
        } else {
          this.res.status(404);
          return this.send('');
        }
      }
    });
  };

}).call(this);
